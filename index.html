<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iPrincesses - Dating & Social</title>

<!-- Firebase SDK v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

<!-- Google Maps SDK -->
<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY"></script>

<style>
  body{font-family:Arial; background:#fff0f5; margin:0; padding:0 20px;}
  h1,h2,h3{text-align:center;color:#ff1493;}
  input,textarea{width:100%; padding:10px; border-radius:20px; border:1px solid #ff69b4; margin:5px 0;}
  button{padding:10px 15px; border:none; border-radius:25px; background:#ff1493; color:white; margin:5px; cursor:pointer; font-weight:bold; transition:0.3s;}
  button:hover{background:#ff69b4;}
  #posts-container,#matches-container{display:flex; flex-wrap:wrap; justify-content:center; gap:15px; margin-top:20px;}
  .card,.swipe-card{background:white; border-radius:15px; padding:15px; width:250px; box-shadow:0px 4px 10px rgba(0,0,0,0.1);}
  .swipe-card{position:absolute; width:100%; height:450px; display:flex; flex-direction:column; justify-content:flex-end; padding:20px; cursor:grab; transition:transform 0.3s, opacity 0.3s;}
  .swipe-card img{width:100%; height:70%; object-fit:cover; border-radius:20px 20px 0 0;}
  #chat-box{display:none; flex-direction:column; max-width:400px; margin:auto;}
  #chat-messages{height:300px; overflow-y:auto; border:1px solid #ff69b4; border-radius:10px; padding:10px; background:#fff0f5;}
  #localVideo,#remoteVideo{display:none; width:100%; border-radius:15px; margin-top:10px;}
  #map{width:100%; height:300px; margin-top:20px; border-radius:15px;}
</style>
</head>
<body>

<h1>Welcome to iPrincesses ‚ù§Ô∏è</h1>

<!-- Signup/Login -->
<div id="auth-section">
<h2>Sign Up / Login</h2>
<form id="signup-form">
<input type="email" id="signup-email" placeholder="Enter email" required>
<input type="password" id="signup-password" placeholder="Enter password" required>
<button type="submit">Sign Up</button>
</form>

<form id="login-form">
<input type="email" id="login-email" placeholder="Enter email" required>
<input type="password" id="login-password" placeholder="Enter password" required>
<button type="submit">Login</button>
</form>
<button id="logout-btn" style="display:none;">Logout</button>
</div>

<hr>

<!-- Search -->
<input type="text" id="search-input" placeholder="Search posts or users...">

<!-- Swipe Profiles -->
<h2>Discover Profiles ‚ù§Ô∏è</h2>
<div id="swipe-container" style="position:relative; width:100%; max-width:400px; margin:auto; height:500px;"></div>
<div id="matches-container"></div>

<!-- Posts Feed -->
<h2>Posts Feed</h2>
<textarea id="post-input" placeholder="Write something..."></textarea>
<button id="add-post">Post</button>
<div id="posts-container"></div>

<!-- Chat & Video -->
<div id="chat-box">
<h3 id="chat-with">Chatting with:</h3>
<div id="chat-messages"></div>
<input type="text" id="chat-input" placeholder="Type a message...">
<button id="send-msg">Send</button>
<button id="start-video">Start Video Call</button>
</div>
<video id="localVideo" autoplay muted></video>
<video id="remoteVideo" autoplay></video>

<!-- Google Map -->
<h2>Share Your Location üìç</h2>
<button id="share-location">Share My Location</button>
<div id="map"></div>

<script>
// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyBE7nyRgJU3-VEvnx_MgUJFcN7Qz04yT0g",
  authDomain: "iprincesses-f4f94.firebaseapp.com",
  projectId: "iprincesses-f4f94",
  storageBucket: "iprincesses-f4f94.appspot.com",
  messagingSenderId: "867887611060",
  appId: "1:867887611060:web:f5c15533019c98d4c26be1",
  measurementId: "G-7C9VZKX8MW"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const storage = firebase.storage();
</script>

<!-- Auth Logic -->
<script>
const signupForm = document.getElementById('signup-form');
const loginForm = document.getElementById('login-form');
const logoutBtn = document.getElementById('logout-btn');

signupForm.addEventListener('submit', e=>{
  e.preventDefault();
  const email = document.getElementById('signup-email').value;
  const password = document.getElementById('signup-password').value;
  auth.createUserWithEmailAndPassword(email,password)
    .then(user=>alert('Signup Success! Welcome '+user.user.email))
    .catch(err=>alert('Error: '+err.message));
});

loginForm.addEventListener('submit', e=>{
  e.preventDefault();
  const email = document.getElementById('login-email').value;
  const password = document.getElementById('login-password').value;
  auth.signInWithEmailAndPassword(email,password)
    .then(user=>{
      alert('Login Success! Hello '+user.user.email);
      logoutBtn.style.display='block';
    })
    .catch(err=>alert('Error: '+err.message));
});

logoutBtn.addEventListener('click', ()=>{
  auth.signOut().then(()=>{
    alert('Logged out successfully');
    logoutBtn.style.display='none';
  });
});
</script>

<!-- Posts -->
<script>
const postsContainer = document.getElementById('posts-container');
const postInput = document.getElementById('post-input');
document.getElementById('add-post').addEventListener('click', async ()=>{
  if(auth.currentUser && postInput.value){
    await db.collection('posts').add({
      user: auth.currentUser.email,
      text: postInput.value,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });
    postInput.value='';
  }
});
db.collection('posts').orderBy('timestamp','desc').onSnapshot(snapshot=>{
  postsContainer.innerHTML='';
  snapshot.forEach(doc=>{
    const p=doc.data();
    const div=document.createElement('div');
    div.className='card';
    div.innerHTML=`<b>${p.user}</b><small>${p.text}</small>`;
    postsContainer.appendChild(div);
  });
});
</script>

<!-- Swipe Profiles -->
<script>
const swipeContainer = document.getElementById('swipe-container');
async function loadProfiles(){
  const snapshot = await db.collection('users').get();
  snapshot.forEach(doc=>{
    const data=doc.data();
    if(auth.currentUser && doc.id!==auth.currentUser.uid){
      const card=document.createElement('div');
      card.className='swipe-card';
      card.innerHTML=`<img src="${data.photoURL||'https://via.placeholder.com/400x300'}"><h3>${data.name||data.email}</h3><p>${data.interests||'No interests added'}</p>`;
      swipeContainer.appendChild(card);
      let startX,currentX;
      card.addEventListener('mousedown',e=>startX=e.clientX);
      card.addEventListener('mousemove',e=>{
        if(startX){currentX=e.clientX; card.style.transform=`translateX(${currentX-startX}px) rotate(${(currentX-startX)/10}deg)`;}
      });
      card.addEventListener('mouseup',e=>{
        if(currentX-startX>100){alert(`You liked ${data.name||data.email}`); card.remove();}
        else if(currentX-startX<-100){alert(`You skipped ${data.name||data.email}`); card.remove();}
        else card.style.transform='translateX(0) rotate(0deg)';
        startX=null; currentX=null;
      });
    }
  });
}
auth.onAuthStateChanged(user=>{ if(user) loadProfiles(); });
</script>

<!-- Chat -->
<script>
const chatBox = document.getElementById('chat-box');
const chatWith = document.getElementById('chat-with');
const chatMessages = document.getElementById('chat-messages');
const chatInput = document.getElementById('chat-input');
const sendMsg = document.getElementById('send-msg');
let currentChatId = null;

function openChat(chatId,name){
  currentChatId=chatId;
  chatBox.style.display='flex';
  chatWith.textContent=`Chatting with: ${name}`;
  chatMessages.innerHTML='';
}

sendMsg.addEventListener('click', async ()=>{
  if(chatInput.value && currentChatId){
    await db.collection('messages').doc(currentChatId).collection('messages').add({
      sender: auth.currentUser.email,
      text: chatInput.value,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });
    chatInput.value='';
  }
});
</script>

<!-- Google Maps Location -->
<script>
const shareBtn=document.getElementById('share-location');
const mapDiv=document.getElementById('map');
let map,marker;

shareBtn.addEventListener('click', ()=>{
  if(navigator.geolocation){
    navigator.geolocation.getCurrentPosition(pos=>{
      const coords={lat:pos.coords.latitude,lng:pos.coords.longitude};
      map=new google.maps.Map(mapDiv,{center:coords,zoom:14});
      marker=new google.maps.Marker({position:coords,map:map,title:"You are here!"});
      alert(`Location shared: ${coords.lat}, ${coords.lng}`);
    });
  }else{alert('Geolocation not supported');}
});
</script>

<!-- Video Call -->
<script>
const localVideo=document.getElementById('localVideo');
const remoteVideo=document.getElementById('remoteVideo');
const startVideo=document.getElementById('start-video');
let localStream,peerConnection;
const servers={iceServers:[{urls:'stun:stun.l.google.com:19302'}]};

startVideo.addEventListener('click', async ()=>{
  localStream = await navigator.mediaDevices.getUserMedia({video:true,audio:true});
  localVideo.srcObject=localStream;
  localVideo.style.display='block';
  
  peerConnection = new RTCPeerConnection(servers);
  localStream.getTracks().forEach(track=>peerConnection.addTrack(track,localStream));
  
  peerConnection.ontrack = event => {
    remoteVideo.srcObject = event.streams[0];
    remoteVideo.style.display='block';
  };
  
  alert('Video call initialized (placeholder, signaling not implemented)');
});
</script>

</body>
</html>
